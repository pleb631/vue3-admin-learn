/* empty css             *//* empty css                *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                   */import{u as H,r as M,_ as Q,a as R,b as X}from"./index.vue_vue_type_script_setup_true_lang-DVn1YcsH.js";import{d as G,r as V,a as K,H as W,ac as Y,c as k,o as _,b as e,i as o,w as l,Q as L,j as E,p as Z,q as p,$ as ee,a0 as te,F as A,y as ae,A as I,ad as le,x as z,a1 as se,S as B,h as re,k as ne,l as oe,X as ie,I as $,a7 as f}from"./index-DOPBV4cN.js";/* empty css                  */const de=["onClick"],ke=G({__name:"index",setup(ue){let m=H(),g=V([]),d=V(0),a=K({attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),v=V([]);W(()=>m.c3Id,()=>{g.value=[],m.c3Id&&b()});const b=async()=>{const{c1Id:r,c2Id:t,c3Id:y}=m;let n=await M(r,t,y);n.code===200&&(g.value=n.data)},S=()=>{Object.assign(a,{attrName:"",attrValueList:[],categoryId:m.c3Id,categoryLevel:3}),d.value=1},O=r=>{d.value=1,Object.assign(a,JSON.parse(JSON.stringify(r)))},N=()=>{d.value=0},T=()=>{a.attrValueList.push({valueName:"",flag:!0}),$(()=>{v.value[a.attrValueList.length-1].focus()})},U=async()=>{(await R(a)).code===200?(d.value=0,f({type:"success",message:a.id?"修改成功":"添加成功"}),b()):f({type:"error",message:a.id?"修改失败":"添加失败"})},q=(r,t)=>{if(r.valueName.trim()===""){a.attrValueList.splice(t,1),f({type:"error",message:"属性值不能为空"});return}if(a.attrValueList.find(n=>{if(n!==r)return n.valueName===r.valueName})){a.attrValueList.splice(t,1),f({type:"error",message:"属性值不能重复"});return}r.flag=!1},D=(r,t)=>{r.flag=!0,$(()=>{v.value[t].focus()})},F=async r=>{(await X(r)).code===200?(f({type:"success",message:"删除成功"}),b()):f({type:"error",message:"删除失败"})};return Y(()=>{m.$reset()}),(r,t)=>{const y=Q,n=Z,u=te,P=le,h=se,C=ee,x=oe,j=ne,w=re,J=ie;return _(),k(A,null,[e(y,{scene:o(d)},null,8,["scene"]),e(J,{style:{margin:"10px 0"}},{default:l(()=>[L(E("div",null,[e(n,{type:"primary",size:"default",icon:"Plus",disabled:!o(m).c3Id,onClick:S},{default:l(()=>t[1]||(t[1]=[p(" 添加平台属性 ")])),_:1},8,["disabled"]),e(C,{border:"",style:{margin:"10px 0"},data:o(g)},{default:l(()=>[e(u,{label:"序号",type:"index",align:"center",width:"80px"}),e(u,{label:"属性名称",prop:"attrName"}),e(u,{label:"属性值名称"},{default:l(({row:s,$index:c})=>[(_(!0),k(A,null,ae(s.attrValueList,(i,ce)=>(_(),I(P,{style:{margin:"5px"},key:i.id},{default:l(()=>[p(z(i.valueName),1)]),_:2},1024))),128))]),_:1}),e(u,{label:"操作"},{default:l(({row:s,$index:c})=>[e(n,{type:"primary",size:"small",icon:"Edit",onClick:i=>O(s)},null,8,["onClick"]),e(h,{title:`你确定删除${s.attrName}?`,width:"200px",onConfirm:i=>F(s.id)},{reference:l(()=>[e(n,{type:"danger",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])],512),[[B,o(d)===0]]),L(E("div",null,[e(w,{inline:!0},{default:l(()=>[e(j,{label:"属性名称"},{default:l(()=>[e(x,{placeholder:"请你输入属性名称",modelValue:o(a).attrName,"onUpdate:modelValue":t[0]||(t[0]=s=>o(a).attrName=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{disabled:!o(a).attrName,type:"primary",size:"default",icon:"Plus",onClick:T},{default:l(()=>t[2]||(t[2]=[p(" 添加属性值 ")])),_:1},8,["disabled"]),e(n,{size:"default",onClick:N},{default:l(()=>t[3]||(t[3]=[p("取消")])),_:1}),e(C,{border:"",style:{margin:"10px 0"},data:o(a).attrValueList},{default:l(()=>[e(u,{label:"序号",width:"80px",type:"index",align:"center"}),e(u,{label:"属性值名称"},{default:l(({row:s,$index:c})=>[s.flag?(_(),I(x,{key:0,ref:i=>o(v)[c]=i,placeholder:"请你输入属性值名称",modelValue:s.valueName,"onUpdate:modelValue":i=>s.valueName=i,onBlur:i=>q(s,c)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(_(),k("div",{key:1,onClick:i=>D(s,c)},z(s.valueName),9,de))]),_:1}),e(u,{label:"属性值操作"},{default:l(({row:s,$index:c})=>[e(n,{type:"danger",size:"small",icon:"Delete",onClick:i=>o(a).attrValueList.splice(c,1)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),e(n,{type:"primary",size:"default",onClick:U,disabled:!(o(a).attrValueList.length>0)},{default:l(()=>t[4]||(t[4]=[p(" 保存 ")])),_:1},8,["disabled"]),e(n,{size:"default",onClick:N},{default:l(()=>t[5]||(t[5]=[p("取消")])),_:1})],512),[[B,o(d)===1]])]),_:1})],64)}}});export{ke as default};
